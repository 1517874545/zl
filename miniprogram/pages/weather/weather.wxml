<navigation-bar
  title="天气"
  back="{{true}}"
  color="#1f2d3d"
  background="#ffffff"
></navigation-bar>
<scroll-view class="page-scroll" scroll-y type="list">
  <view class="weather-page">
    <!-- 当前天气 -->
    <view class="current-weather">
      <view class="city-info">
        <text class="city-name">{{currentCity}}</text>
        <text class="update-time">更新于 {{updateTime}}</text>
      </view>
      <view class="weather-main">
        <view class="temperature">{{currentTemp}}°</view>
        <view class="weather-desc">{{weatherDesc}}</view>
        <view class="weather-details">
          <text>湿度 {{humidity}}%</text>
          <text>风速 {{windSpeed}}km/h</text>
          <text>空气质量 {{airQuality}}</text>
        </view>
      </view>
    </view>

    <!-- 未来几天预报 -->
    <view class="forecast-section">
      <view class="section-title">未来7天</view>
      <view class="forecast-list">
        <view class="forecast-item" wx:for="{{forecast}}" wx:key="date">
          <view class="forecast-date">{{item.date}}</view>
          <view class="forecast-weather">{{item.weather}}</view>
          <view class="forecast-temp">
            <text class="high">{{item.high}}°</text>
            <text class="low">{{item.low}}°</text>
          </view>
        </view>
      </view>
    </view>

    <!-- 生活建议 -->
    <view class="suggestion-section" wx:if="{{suggestion}}">
      <view class="section-title">生活建议</view>
      <view class="suggestion-content">{{suggestion}}</view>
    </view>

    <!-- 城市切换 -->
    <view class="city-section">
      <button class="city-btn" bindtap="onChangeCity">切换城市</button>
    </view>
  </view>
</scroll-view>

<!-- 城市选择弹窗 -->
<view wx:if="{{showCityPicker}}" class="city-modal-mask" bindtap="onCloseCityPicker">
  <view class="city-modal" catchtap="noop">
    <view class="modal-header">
      <text class="modal-title">选择城市</text>
      <text class="modal-close" bindtap="onCloseCityPicker">✕</text>
    </view>
    <view class="city-list">
      <view 
        class="city-item {{item.isDefault ? 'default' : ''}}"
        wx:for="{{cityList}}"
        wx:key="id"
        bindtap="onSelectCity"
        data-city="{{item}}"
      >
        <text class="city-name">{{item.name}}</text>
        <text class="city-default" wx:if="{{item.isDefault}}">默认</text>
      </view>
      <view class="city-item add" bindtap="onAddCity">
        <text>+ 添加城市</text>
      </view>
    </view>
  </view>
</view>

